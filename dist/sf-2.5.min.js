define("sfr/router/lang/extend",["require"],function(){function t(t,r){for(var e=1,n=arguments.length;n>e;e++)if(r=arguments[e])for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);return t}return t}),define("sfr/router/lang/inherits",["require"],function(){function t(t,r){var e=function(){};e.prototype=r.prototype;var n=t.prototype,o=t.prototype=new e;for(var i in n)n.hasOwnProperty(i)&&(o[i]=n[i]);return t.prototype.constructor=t,t}return t}),define("sfr/router/emitter",["require"],function(){function t(){}var r=t.prototype;
r._getEvents=function(){return this._events||(this._events={}),this._events},r._getMaxListeners=function(){return isNaN(this.maxListeners)&&(this.maxListeners=10),this.maxListeners},r.on=function(t,r){var e=this._getEvents(),n=this._getMaxListeners();e[t]=e[t]||[];var o=e[t].length;if(o>=n&&0!==n)throw new RangeError("Warning: possible Emitter memory leak detected. "+o+" listeners added.");return e[t].push(r),this},r.once=function(t,r){function e(){n.off(t,e),r.apply(this,arguments)}var n=this;return e.listener=r,this.on(t,e),this
},r.off=function(t,r){var e=this._getEvents();if(0===arguments.length)return this._events={},this;var n=e[t];if(!n)return this;if(1===arguments.length)return delete e[t],this;for(var o,i=0;i<n.length;i++)if(o=n[i],o===r||o.listener===r){n.splice(i,1);break}return this},r.emit=function(t){for(var r=this._getEvents(),e=r[t],n=[],o=1;o<arguments.length;o++)n.push(arguments[o]);if(e)for(e=e.slice(0),o=0;o<e.length;o++)e[o].apply(this,n);return this},r.listeners=function(t){var r=this._getEvents();return r[t]||[]
},r.setMaxListeners=function(t){return this.maxListeners=t,this};var e=Object.keys(r);return t.mixin=function(t){for(var n,o=0,i=e.length;i>o;o++)n=e[o],t[n]=r[n];return t},t}),define("sfr/router/router/URL",["require","sfr/router/uri/component/Path","sfr/router/uri/component/Query","sfr/router/uri/component/Fragment","sfr/router/router/config"],function(t){function r(t,r){r=r||{},t=(t||"").trim()||i.path;var s=this.token=r.token||u,a=r.root||i.root;"/"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1)),this.root=a,t=t.split("#"),this.fragment=new o(t[1]),t=t[0].split(s);
var c=r.base||{};this.path=new e(t[0],c.path),this.query=new n(t[1]);var f=this.path.get();this.outRoot=0===f.indexOf(".."),this.outRoot&&(f=e.resolve(a+"/",f),0===f.indexOf(a)&&(f=f.substring(a.length),this.path.set(f),this.outRoot=!1)),this.outRoot||"/"===f.charAt(0)||this.path.set("/"+f),r.query&&this.query.add(r.query)}var e=t("sfr/router/uri/component/Path"),n=t("sfr/router/uri/component/Query"),o=t("sfr/router/uri/component/Fragment"),i=t("sfr/router/router/config"),u="?";return r.prototype.toString=function(){var t=this.root,r=this.path.get();
return r=this.outRoot?e.resolve(t+"/",r):t+r,r+this.query.toString(this.token)+this.fragment.toString()},r.prototype.equalPath=function(t){return this.path.get()===t},r.prototype.equal=function(t){return this.query.equal(t.query)&&this.equalPath(t.path.get())},r.prototype.equalWithFragment=function(t){return this.equal(t)&&this.fragment.equal(t.fragment)},r.prototype.getQuery=function(){return this.query.get()},r.prototype.getPath=function(){return this.path.get()},r}),define("sfr/router/router/config",[],{path:"/",root:"",mode:"async"}),define("sfr/router/router/controller",["require","sfr/router/lang/extend","sfr/router/router/URL","sfr/router/router/config"],function(t){function r(t,r){e(t,r)||(s(t,r),a=t)
}function e(t,r){return a&&t.equal(a)&&!r.force}function n(t){var r=p.root;if("/"===t.charAt(0)&&r)if(0===t.indexOf(r))t=t.replace(r,"");else{var e=r.split("/").slice(1);e=e.map(function(){return".."}),t=e.join("/")+t,a=null}return t}function o(t,r){return t||(t=n(location.pathname)),new f(t,{query:r,base:a})}function i(t,e){t=t||{};var i=n(location.pathname);if(location.search.length>1&&(i+=location.search),i=o(i),i.outRoot)return u(i.toString(),!0);var s=e?{src:"sync"}:c({},t.state,{src:"history"});
r(i,s)}function u(t,r){l.dispose(),r?location.replace(t):location.href=t}var s,a,c=t("sfr/router/lang/extend"),f=t("sfr/router/router/URL"),p=t("sfr/router/router/config"),l={};return l.init=function(t){window.addEventListener("popstate",i,!1),s=t,i(null,!0)},l.redirect=function(t,n,i){return i=i||{},t=o(t,n),t.outRoot||"page"===p.mode?!e(t,i)&&u(t.toString()):(a.equalWithFragment(t)||i.silent||history.pushState(i,i.title,t.toString()),void r(t,i))},l.reset=function(t,n,i){return i=i||{},t=o(t,n),t.outRoot||"page"===p.mode?!e(t,i)&&u(t.toString()):(i.silent?a=t:r(t,i),void history.replaceState(i,i.title,t.toString()))
},l.dispose=function(){window.removeEventListener("popstate",i,!1),a=null},l}),define("sfr/router/router",["require","sfr/router/lang/extend","sfr/router/router/config","sfr/router/router/controller"],function(t){function r(t){var r=-1;return t=t.toString(),p.some(function(e,n){return e.raw.toString()===t&&(r=n),-1!==r}),r}function e(t,r){for(var e,n={},o=r.params||[],i=t.match(r.path)||[],u=1;u<i.length;u++)e=o[u-1]||"$"+u,n[e]=decodeURIComponent(i[u]);return n}function n(t,r){function o(){if(h=!1,u){var t=s({},u);
u=null,n(t.url,t.options)}}if(r=r||{},h)return void(u={url:t,options:r});h=!0;var i,a,c=s({},t.getQuery()),f={},d=t.getPath();if(p.some(function(r){return r.path instanceof RegExp?r.path.test(d)&&(i=r,f=e(d,r)):t.equalPath(r.path)&&(i=r),r.path||(a=r),!!i}),i=i||a,!i)throw u=null,h=!1,new Error("can not found route for: "+d);r.title&&(document.title=r.title);var g={path:d,query:c,params:f,url:t.toString(),options:r},y=[g,l];l=g,i.fn.length>y.length?(y.push(o),i.fn.apply(i.thisArg,y)):(i.fn.apply(i.thisArg,y),o())
}function o(t){var r={params:[]};return r.path=t.replace(/:([^\/]+)/g,function(t,e){return r.params.push(e),"([^/]+)"}),r.path=new RegExp("^"+r.path+"$"),r}function i(t,r,e){var n={raw:t,path:t,fn:r,thisArg:e};!(t instanceof RegExp)&&t.indexOf(":")>=0&&(n=s(n,o(t))),p.push(n)}var u,s=t("sfr/router/lang/extend"),a=t("sfr/router/router/config"),c=t("sfr/router/router/controller"),f={},p=[],l={},h=!1;return f.reset=function(t,r,e){c.reset(t,r,e)},f.config=function(t){t=t||{};var r=t.root;r&&"/"===r.charAt(r.length-1)&&(r=t.root=r.substring(0,r.length-1)),r&&"/"!==r.charAt(0)&&(t.root="/"+r),s(a,t)
},f.add=function(t,e,n){if(r(t)>=0)throw new Error("path already exist");i(t,e,n)},f.remove=function(t){var e=r(t);e>=0&&p.splice(e,1)},f.exist=function(t){return r(t)>=0},f.clear=function(){p=[]},f.redirect=function(t,r,e){c.redirect(t,r,e)},f.start=function(t){f.config(t),c.init(n)},f.stop=function(){c.dispose(),f.clear(),u=null,l={}},f.controller=function(t){c=t},f}),define("sfr/router/uri",["require","sfr/router/uri/URI","sfr/router/uri/util/uri-parser","sfr/router/uri/component/Path"],function(t){var r=t("sfr/router/uri/URI"),e=function(t){return new r(t)
};return e.parse=t("sfr/router/uri/util/uri-parser"),e.resolve=t("sfr/router/uri/component/Path").resolve,e}),define("sfr/router/uri/URI",["require","sfr/router/uri/util/uri-parser","sfr/router/uri/component/Scheme","sfr/router/uri/component/UserName","sfr/router/uri/component/Password","sfr/router/uri/component/Host","sfr/router/uri/component/Port","sfr/router/uri/component/Path","sfr/router/uri/component/Query","sfr/router/uri/component/Fragment"],function(t){function r(t){t=n(t);var r,e=this;Object.keys(o).forEach(function(n){r=o[n],e[n]=new r(t[n])
})}function e(t){var r=[],e=t.username.toString(),n=t.password.toString(),o=t.host.toString(),i=t.port.toString();return(e||n)&&r.push(e+":"+n+"@"),r.push(o),r.push(i),r.join("")}var n=t("sfr/router/uri/util/uri-parser"),o={scheme:t("sfr/router/uri/component/Scheme"),username:t("sfr/router/uri/component/UserName"),password:t("sfr/router/uri/component/Password"),host:t("sfr/router/uri/component/Host"),port:t("sfr/router/uri/component/Port"),path:t("sfr/router/uri/component/Path"),query:t("sfr/router/uri/component/Query"),fragment:t("sfr/router/uri/component/Fragment")};
return r.prototype.set=function(){var t=0,r={};arguments.length>1&&(r.name=arguments[t++]),r.data=Array.prototype.slice.call(arguments,t);var e=this[r.name];if(e)e.set.apply(e,r.data);else{var i=this,u=n(r.data[0]);Object.keys(o).forEach(function(t){i[t].set(u[t])})}},r.prototype.get=function(){var t={name:arguments[0],data:Array.prototype.slice.call(arguments,1)},r=this[t.name];return r?r.get.apply(r,t.data):void 0},r.prototype.toString=function(t){var r,n=this[t];if(n)r=n.toString();else{r=[];var o=this.scheme.toString();
o&&r.push(o+":");var i=e(this);o&&i&&r.push("//"),r.push(i),r.push(this.path.toString()),r.push(this.query.toString()),r.push(this.fragment.toString()),r=r.join("")}return r},r.prototype.equal=function(t){t instanceof r||(t=new r(t));for(var e,n=!0,i=Object.keys(o),u=0;n&&(e=i[u]);u++)n="port"===e?this[e].equal(t[e].get(),this.scheme.get()):this[e].equal(t[e]);return n},r}),define("sfr/router/uri/component/Abstract",["require"],function(){function t(){var t=Array.prototype.slice.call(arguments);this.set.apply(this,t)
}return t.prototype.get=function(){return this.data},t.prototype.set=function(t){this.data=t||""},t.prototype.add=function(t){this.set(t)},t.prototype.remove=function(){this.data=""},t.prototype.toString=function(){return this.data.toString()},t.prototype.equal=function(r){return r instanceof t&&(r=r.get()),this.data==r},t}),define("sfr/router/uri/component/Fragment",["require","sfr/router/lang/inherits","sfr/router/uri/component/Abstract"],function(t){function r(t){n.call(this,t)}var e=t("sfr/router/lang/inherits"),n=t("sfr/router/uri/component/Abstract"),o="#";
return e(r,n),r.prototype.toString=function(t){return t=t||o,this.data?t+this.data:""},r}),define("sfr/router/uri/component/Host",["require","sfr/router/lang/inherits","sfr/router/uri/component/Abstract"],function(t){function r(t){n.call(this,t)}var e=t("sfr/router/lang/inherits"),n=t("sfr/router/uri/component/Abstract");return e(r,n),r.prototype.set=function(t){t=t||"",this.data=t.toLowerCase()},r.prototype.equal=function(t){return t=t instanceof r?t.get():t||"",this.data===t.toLowerCase()},r}),define("sfr/router/uri/component/Password",["require","sfr/router/lang/inherits","sfr/router/uri/component/Abstract"],function(t){function r(t){n.call(this,t)
}var e=t("sfr/router/lang/inherits"),n=t("sfr/router/uri/component/Abstract");return e(r,n),r}),define("sfr/router/uri/component/Path",["require","sfr/router/lang/inherits","sfr/router/uri/component/Abstract"],function(t){function r(t){return t||(t="/"),t}function e(t){return t=t.split("/"),t.pop(),t.join("/")}function n(t,r){for(var e,n=0,o=t.length-1;e=t[o];o--)"."===e?t.splice(o,1):".."===e?(t.splice(o,1),n++):n&&(t.splice(o,1),n--);if(r)for(;n-->0;)t.unshift("..");return t}function o(t,r){u.call(this,t,r)
}var i=t("sfr/router/lang/inherits"),u=t("sfr/router/uri/component/Abstract");return o.resolve=function(t,r){if(r=r||"","/"===r.charAt(0))return o.resolve(r);var i="/"===t.charAt(0),u=!1;r?(t=e(t),u="/"===r.charAt(r.length-1)):t.length>1&&(u="/"===t.charAt(t.length-1));var s=t.split("/").concat(r.split("/")).filter(function(t){return!!t});return s=n(s,!i),(i?"/":"")+(s.length>0?s.join("/")+(u?"/":""):"")},i(o,u),o.prototype.set=function(t,r){r instanceof o&&(r=r.get());var e=[t||""];r&&e.unshift(r),this.data=o.resolve.apply(o,e)
},o.prototype.equal=function(t){var e=r(this.data);return t=r(t instanceof o?t.get():o.resolve(t||"")),e===t},o.prototype.resolve=function(t,r){t instanceof o&&(t=t.get());var e=[this.data];r?e.unshift(t):e.push(t),this.data=o.resolve.apply(o,e)},o}),define("sfr/router/uri/component/Port",["require","sfr/router/lang/inherits","sfr/router/uri/component/Abstract"],function(t){function r(t){n.call(this,t)}var e=t("sfr/router/lang/inherits"),n=t("sfr/router/uri/component/Abstract"),o={ftp:"21",ssh:"22",telnet:"23",http:"80",https:"443",ws:"80",wss:"443"};
return e(r,n),r.prototype.equal=function(t,e){var n=this.data||o[e];return t instanceof r&&(t=t.get()),t=t||o[e],n===t},r.prototype.toString=function(){return this.data?":"+this.data:""},r}),define("sfr/router/uri/component/Query",["require","sfr/router/lang/inherits","sfr/router/lang/extend","sfr/router/uri/component/Abstract","sfr/router/uri/util/parse-query","sfr/router/uri/util/stringify-query"],function(t){function r(t){return"[object Object]"===Object.prototype.toString.call(t)}function e(t){return"string"==typeof t
}function n(t,r){if(!Array.isArray(t)||!Array.isArray(r))return!1;if(t.length!==r.length)return!1;t=t.slice(0),t=t.slice(0),t.sort(),r.sort();for(var e=!0,n=0,o=t.length;e&&o>n;n++)e=t[n]==r[n];return e}function o(t,e){if(!r(t)||!r(e))return!1;var o=Object.keys(t),i=Object.keys(e);if(o.length!==i.length)return!1;for(var u,s,a=!0,c=0;a&&(u=o[c]);c++){if(!e.hasOwnProperty(u)){a=!1;break}s=t[u],a=Array.isArray(s)?n(s,e[u]):s==e[u]}return a}function i(t){return t=Array.isArray(t)?t.map(function(t){return decodeURIComponent(t||"")
}):t||e(t)?decodeURIComponent(t):null}function u(t,r,e){var n=e[t];return r=i(r),n?(Array.isArray(n)||(n=[n]),Array.isArray(r)?n=n.concat(r):n.push(r)):n=r,e[t]=n,e}function s(t){t=t||{},f.call(this,t)}var a=t("sfr/router/lang/inherits"),c=t("sfr/router/lang/extend"),f=t("sfr/router/uri/component/Abstract"),p=t("sfr/router/uri/util/parse-query"),l=t("sfr/router/uri/util/stringify-query"),h="?";return a(s,f),s.prototype.set=function(){if(1===arguments.length){var t=arguments[0];if(r(t)){var e=this.data={};
Object.keys(t).forEach(function(r){e[r]=i(t[r])})}else this.data=p(t)}else this.data[arguments[0]]=i(arguments[1])},s.prototype.get=function(t){return t?this.data[t]:c({},this.data)},s.prototype.toString=function(t){t=t||h;var r=l(this.data);return r?t+r:""},s.prototype.equal=function(t){return e(t)?t=p(t):t instanceof s&&(t=t.get()),o(this.data,t)},s.prototype.add=function(t,e){var n=this.data;r(t)?Object.keys(t).forEach(function(r){u(r,t[r],n)}):u(t,e,n),this.data=n},s.prototype.remove=function(t){t?this.data.hasOwnProperty(t)&&delete this.data[t]:this.data={}
},s}),define("sfr/router/uri/component/Scheme",["require","sfr/router/lang/inherits","sfr/router/uri/component/Abstract"],function(t){function r(t){n.call(this,t)}var e=t("sfr/router/lang/inherits"),n=t("sfr/router/uri/component/Abstract");return e(r,n),r.prototype.set=function(t){t=t||"",this.data=t.toLowerCase()},r.prototype.equal=function(t){return t=t instanceof r?t.get():t||"",this.data===t.toLowerCase()},r}),define("sfr/router/uri/component/UserName",["require","sfr/router/lang/inherits","sfr/router/uri/component/Abstract"],function(t){function r(t){n.call(this,t)
}var e=t("sfr/router/lang/inherits"),n=t("sfr/router/uri/component/Abstract");return e(r,n),r}),define("sfr/router/uri/util/parse-query",["require"],function(){function t(t){var r={};t=t.split("&");var e,n;return t.forEach(function(t){t&&(t=t.split("="),e=t[0],n=t.length>=2?decodeURIComponent(t[1]):null,r[e]?(Array.isArray(r[e])||(r[e]=[r[e]]),r[e].push(n)):r[e]=n)}),r}return t}),define("sfr/router/uri/util/stringify-query",["require"],function(){function t(t){var r,e=[];return Object.keys(t).forEach(function(n){r=t[n],Array.isArray(r)||(r=[r]),r.forEach(function(t){e.push(null===t?n:n+"="+encodeURIComponent(t||""))
})}),e.join("&")}return t}),define("sfr/router/uri/util/uri-parser",["require","sfr/router/lang/extend"],function(t){function r(t){var r={},e=["scheme","username","password","host","port","path","query","fragment"];return e.forEach(function(e){r[e]=t[e]||u}),r}function e(t){var r={};return t.replace(/^([^@]+@)?([^:]+)(:\d+)?$/,function(t,e,n,o){e&&(e=e.slice(0,-1),e=e.split(":"),r.username=e[0],r.password=e[1]),r.host=n,o&&(r.port=o.substring(1))}),r}function n(t,r){var n=/[^:]+:\d{2,}(\/|$)/.test(t);
return n&&(t=t.split("/"),s(r,e(t.shift())),t.length>0&&(r.path="/"+t.join("/"))),n}function o(t,r){var e=t.indexOf(":"),n=t.indexOf("/");n=n>=0?n:t.length;var o=e>=0&&n>e;return o&&(r.scheme=t.substring(0,e),r.path=t.substring(e+1)),o}function i(t){var r={},i=t.indexOf("#");return i>=0&&(r.fragment=t.substring(i+1),t=t.substring(0,i)),i=t.indexOf("?"),i>=0&&(r.query=t.substring(i+1),t=t.substring(0,i)),i=t.indexOf("://"),i>=0?(r.scheme=t.substring(0,i),t=t.substring(i+3),"file"===r.scheme?r.path=t:(t=t.split("/"),s(r,e(t.shift())),t.length>0&&(r.path="/"+t.join("/"))),r):n(t,r)?r:o(t,r)?r:(t=t.split("/"),r.host=t.shift(),t.length>0&&(r.path="/"+t.join("/")),r)
}var u,s=t("sfr/router/lang/extend");return function(t){return("string"==typeof t||t instanceof String)&&(t=i(t)),r(t)}}),define("sfr/utils/http",["sfr/utils/promise","sfr/utils/underscore","sfr/utils/dom"],function(t,r,e){function n(t){return t instanceof FormData?"multipart/form-data":"application/x-www-form-urlencoded; charset=UTF-8"}function o(e){var n;try{n=u()}catch(o){return t.reject(null,"",o)}return n.open(e.method,e.url,!0),r.forOwn(e.headers,function(t,r){n.setRequestHeader(r,t)}),new t(function(t,r){n.onreadystatechange=function(){4==n.readyState&&(n=i(n),n.status>=200&&n.status<300?t(n.responseBody,n.status,n):r(n,n.status,null))
},n.send(e.data)})}function i(t){var e=t.getAllResponseHeaders().split("\r\n").filter(r.negate(r.isEmpty)).map(function(t){return r.split(t,/\s*:\s*/)});if(t.responseHeaders=r.fromPairs(e),t.responseBody=t.responseText,"application/json"===t.responseHeaders["Content-Type"])try{t.responseBody=JSON.parse(t.responseText)}catch(n){console.warn("Invalid JSON content with Content-Type: application/json")}return t}function u(){var t=!1;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Microsoft.XMLHTTP")
}catch(r){}if(!t)throw"Cannot create an XHR instance";return t}var s={};return s.ajax=function(t,i){return"object"==typeof t&&(i=t,t=""),i=r.defaultsDeep(i,{url:t,method:i&&i.type||"GET",headers:{},data:null,jsonp:!1,jsonpCallback:"cb"}),r.forOwn(i.headers,function(t,r){i.headers[r]=t.toLowerCase(t)}),i.headers["content-type"]=i.headers["content-type"]||n(i.data),/application\/json/.test(i.headers["content-type"])?i.data=JSON.stringify(i.data):/form-urlencoded/.test(i.headers["content-type"])&&(i.data=e.param(i.data)),o(i)
},s.get=function(t,r){return s.ajax(t,{data:r})},s.post=function(t,r){return s.ajax(t,{method:"POST",data:r})},s.put=function(t,r){return s.ajax(t,{method:"PUT",data:r})},s.delete=function(t,r){return s.ajax(t,{method:"DELETE",data:r})},s}),define("sfr/utils/dom",["sfr/utils/underscore"],function(t){function r(r){return t.isObject(r)?t.map(r,function(t,r){return encodeURIComponent(r)+"="+encodeURIComponent(t)}).join("&"):r}return{param:r}}),define("sfr/utils/underscore",["require"],function(){function t(t){return t=n(t),t.shift(),t
}function r(t){return Object.keys(t)}function e(t,r){t=t||{};for(var e in t)if(t.hasOwnProperty(e)&&r(t[e],e,t)===!1)break;return t}function n(t){return t?_.slice.call(t):[]}function o(r){var e=t(arguments);return _.forEach.apply(r||[],e)}function i(r,n){if(p(r)){var o=[];return e(r,function(){o.push(n.apply(null,arguments))}),o}var i=t(arguments);return _.map.apply(r||[],i)}function u(r){var e=t(arguments);return _.slice.apply(r||[],e)}function s(r){var e=t(arguments);return _.splice.apply(r||[],e)
}function a(r){var e=t(arguments);return A.split.apply(r||"",e)}function c(r){return t(arguments).reduce(function(t,r){return t.replace("%s",r)},r)}function f(){var t={},r=u(arguments,0);return o(r,function(r){e(r,function(r,e){t.hasOwnProperty(e)||(t[e]=r)})}),t}function p(t){return null!==t&&"object"==typeof t}function l(t){return t instanceof String||"string"==typeof t}function h(t,r){return t?void e(r,function(r,e){return p(r)&&p(t[e])?h(t[e],r):void(t[e]=r)}):t}function d(){var t={},r=u(arguments,0).reverse();
return o(r,function(r){h(t,r)}),t}function g(t){var r={};return i(t,function(t){var e=t[0],n=t[1];r[e]=n}),r}function y(t){return t instanceof Array}function m(t){return y(t)?0===t.length:!t}function v(t){return function(){return!t.apply(null,arguments)}}function w(t){var r=u(arguments);return function(){var e=[0,0];e.push(r);var n=_.splice.apply(arguments,e);return t.apply(null,n)}}function b(t){var r=u(arguments);return r.shift(),function(){var e=u(arguments),n=[e,arguments.length,0].concat(r);
return s.apply(null,n),t.apply(null,e)}}var q={},_=Array.prototype,A=(Object.prototype,String.prototype);return q.keysIn=r,q.forOwn=e,q.defaults=f,q.defaultsDeep=d,q.fromPairs=g,q.slice=u,q.splice=s,q.forEach=o,q.map=i,q.toArray=n,q.split=a,q.format=c,q.isArray=y,q.isEmpty=m,q.isString=l,q.isObject=p,q.partial=w,q.partialRight=b,q.negate=v,q}),define("sfr/utils/promise",["require"],function(){function t(r){if(!(this instanceof t))throw"Promise must be called with new operator";if("function"!=typeof r)throw"callback not defined";
this._handlers=[],this._state="init",this._errors=[],this._results=[],setTimeout(function(){r(this._onFulfilled.bind(this),this._onRejected.bind(this))}.bind(this))}function r(t){return t&&"function"==typeof t.then}return t.prototype.then=function(t){return"fulfilled"===this._state?this._callHandler(t,this._results):this._handlers.push({type:"then",cb:t}),this},t.prototype.catch=function(t){return"rejected"===this._state?this._callHandler(t,this._errors):this._handlers.push({type:"catch",cb:t}),this
},t.prototype.finally=function(t){"fulfilled"===this._state?this._callHandler(t,this._results):"rejected"===this._state?this._callHandler(t,this._errors):this._handlers.push({type:"finally",cb:t})},t.resolve=function(e){var n=arguments;return r(e)?e:new t(function(t){return t.apply(null,n)})},t.reject=function(){var r=arguments;return new t(function(t,e){return e.apply(null,r)})},t.all=function(r){var e=r.map(function(){return void 0}),n=0,o="pending";return new t(function(i,u){function s(){"pending"===o&&(o="fulfilled",i(e))
}function a(){"pending"===o&&(o="rejected",u.apply(null,arguments))}r.map(t.resolve).forEach(function(t,o){t.then(function(t){e[o]=t,n++,n===r.length&&s()}).catch(a)})})},t.prototype._onFulfilled=function(t){if(r(t))return t.then(this._onFulfilled.bind(this)).catch(this._onRejected.bind(this));this._results=arguments;var e=this._getNextHandler("then");return e?this._callHandler(e,this._results):(e=this._getNextHandler("finally"))?this._callHandler(e,this._results):void(this._state="fulfilled")},t.prototype._onRejected=function(){this._errors=arguments;
var t=this._getNextHandler("catch");return t?this._callHandler(t,this._errors):(t=this._getNextHandler("finally"))?this._callHandler(t,this._errors):void(this._state="rejected")},t.prototype._callHandler=function(t,r){var e,n=null;try{e=t.apply(null,r)}catch(o){n=o}n?this._onRejected(n):this._onFulfilled(e)},t.prototype._getNextHandler=function(t){for(var r;(r=this._handlers.shift())&&r.type!==t;);return r?r.cb:null},t}),define("sfr/action",["require","sfr/router/router"],function(t){function r(t){return"object"==typeof t&&t.create&&t.attach&&t.detach&&t.destroy&&t.update?!0:!1
}function e(){function t(){return deferred=$.Deferred(),deferred.resolve(),$.each(e,function(){var t=this;deferred=deferred.then(function(){return t()})}),e=[],deferred}function r(t,r){var n=2 in arguments&&Array.prototype.slice.call(arguments,2);"function"==typeof t&&e.push(function(){return t.apply(r,n?n:[])})}var e=[];return{push:r,excute:t}}function n(t){var r=$(this),e=r.attr("data-sf-href");if(e){var n=r.attr("data-sf-options");try{n=$.parseJSON(n)?$.parseJSON(n):{}}catch(o){n={}}n=$.extend(n,{src:"hijack"}),u.redirect(e,null,n),t.preventDefault()
}}var o,i=t("sfr/router/router"),u={},s={},a={};return u.regist=function(t,e){if(!t)throw new Error("illegal action name");if(!e)throw new Error("illegal action option");!s.hasOwnProperty(t)&&r(e)&&(i.add(t,this.dispatch),s[t]=e)},u.dispatch=function(t,r){var n=new e,i=s[t.path],u=s[r.path];return t.options=t.options||{},"sync"===t.options.src?void(o=t.url):(a.src&&(t.options.src=a.src),u&&n.push(u.detach,u,t,r),i&&n.push(i.create,i,t,r),r.url!==o&&u&&n.push(u.destroy,u,t,r),i&&n.push(i.attach,i,t,r),n.push(function(){a.src=void 0
}),n.excute())},u.remove=function(t){s.hasOwnProperty(t)&&delete s[t]},u.exist=function(t){return s.hasOwnProperty(t)},u.clear=function(){s={},i.clear()},u.redirect=function(t,r,e){i.redirect(t,r,e)},u.back=function(){a.src="back",history.back()},u.reset=function(t,r,e){i.reset(t,r,e)},u.start=function(){$(document).delegate("a","click",n)},u.config=function(t){return $.extend(a,t),a},u.update=function(t,r,e,n){e=e?e:{},e.hasOwnProperty("silent")||(e.silent=!0);var o=location.href.replace(/.*\/([^\/]+$)/,"/$1"),u=location.pathname.replace(/.*\/([^\/]+$)/,"/$1");
if(s.hasOwnProperty(u)){var a=s[u];a.update({path:u,url:t,prevUrl:o,query:r,options:e,container:n.container,view:n.view})}i.reset(t,r,e)},u}),define("sfr/service",["require"],function(){var t={},r=function(t){var r=this;r.options=t};return r.prototype.create=function(){},r.prototype.attach=function(){},r.prototype.detach=function(){},r.prototype.destroy=function(){},r.prototype.update=function(){},t.create=function(){var t=function(){};return t.prototype=Object.create(r.prototype),t},t}),define("sfr/resource",["sfr/utils/http","sfr/utils/underscore"],function(t,r){function e(t){this.url=t
}return e.prototype={getUrl:function(t){var e=this.url;return r.forOwn(t,function(t,r){e=e.replace(":"+r,t)}),e=e.replace(/:\w+/g,"")},create:function(r,e){var n=this.getUrl(e);return t.post(n,r)},query:function(r){var e=this.getUrl(r);return t.get(e)},update:function(r,e){var n=this.getUrl(e);return t.put(n,r)},"delete":function(r){var e=this.getUrl(r);return t.delete(e)}},e}),define("sfr/view",["require"],function(){var t=function(){this._init()};return t.prototype={_init:function(){},set:function(){},get:function(){},create:function(){},render:function(){},update:function(){},attach:function(){},detach:function(){},destroy:function(){},on:function(){},off:function(){}},t
});